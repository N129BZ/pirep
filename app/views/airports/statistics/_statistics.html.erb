<% runways = @airport.runways.order(length: :desc) %>

<div class="card my-2">
  <div class="card-header">
    <i class="fas fa-plane-departure"></i> Airport Statistics
  </div>
</div>

<div class="row">
  <div class="col-sm mb-2 pr-1">
    <%= render partial: 'airports/statistics/statistics_box', locals: {label: 'Elevation', value: @airport.elevation, units: :ft, icon: :mountain, theme: @airport.elevation_threat_level} %>
  </div>

  <div class="col-sm mb-2 pl-1">
    <%= render partial: 'airports/statistics/statistics_box', locals: {label: 'Runway %s' % runways.first.number, value: runways.first.length, units: :ft, icon: :road, theme: runways.first.length_threat_level} %>
  </div>

  <div class="w-100"></div>

  <% runways.offset(1).in_groups_of(2).each do |grouped_runways| %>
    <% grouped_runways.each_with_index do |runway, index| %>
      <% next unless runway %>

      <div class="col-sm mb-2 <%= grouped_runways.compact.count == 2 ? (index == 0 ? 'pr-1' : 'pl-1') : '' %>">
        <%= render partial: 'airports/statistics/statistics_box', locals: {label: 'Runway %s' % runway.number, value: runway.length, units: :ft, icon: :road, theme: runway.length_threat_level} %>
      </div>
    <% end %>

    <div class="w-100"></div>
  <% end %>
</div>

<div class="landing-rights d-flex mb-2">
  <div class="icon text-center d-flex justify-content-center align-items-center theme-<%= Airport::LANDING_RIGHTS_TYPES[@airport.landing_rights][:color] %>">
    <i class="fas fa-<%= Airport::LANDING_RIGHTS_TYPES[@airport.landing_rights][:icon] %>"></i>
  </div>

  <div class="label flex-fill p-2">
    <div class="mb-1">
      Access: <%= Airport::LANDING_RIGHTS_TYPES[@airport.landing_rights][:long_description] %>
    </div>

    <div class="small mb-1">
      <% if @airport.landing_rights == :private_ %>
        Some privately owned airports are actually open to the public or the owners are happy to have pilots stop by with prior permission given. If this is the case for this airport enter it as such!
      <% elsif @airport.landing_requirements.present? %>
        <%= Airport::LANDING_RIGHTS_TYPES[@airport.landing_rights][:short_requirements_label] %>: <%= @airport.landing_requirements %>
     <% end %>
    </div>

    <div>
      <button type="button" class="btn btn-outline-primary btn-sm" data-toggle="collapse" data-target="landing-rights-form">Edit Airport Access</button>
    </div>
  </div>
</div>

<% content_for :collapsible_content, flush: true do %>
  <%= render 'airports/statistics/landing_rights_form' %>
<% end %>

<%= render 'shared/collapsible', id: 'landing-rights-form' %>
